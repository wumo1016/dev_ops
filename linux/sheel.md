## [sheel](http://www.zhufengpeixun.com/strong/html/125.5.linux-shell.html)

### 基础

- 介绍
  - 它为用户提供了一个向 Linux 内核发送请求以便运行程序的界面系统级程序
  - Shell 是解释执行的脚本语言
  - 在 Shell 中可以直接调用 Linux 系统命令
- 命令
  - `echo`
    - `-e`: 激活转义字符
- 编写执行 sheel
  - 在文件的开头写上 `#!/bin/bash`
  - 文件以.sh 结尾
- 执行
  - 通过 `sh [文件名]` 执行 sheel 脚本
  - 直接 [文件名] 执行，需要添加到 PATH 中去
    - 给 sheel 脚本添加执行权限 `chmod +x [文件名]`
    - 想要脚本可全局执行 就把脚本添加到 PATH 中去
    - 将目录添加到 PATH 中去 例如 `export PATH="$PATH":/root/shells`
- `alias`: 设置别名
  - 例如 `alias cp="cp -i"` 再输入`cp`就等于`cp -i`
  - 临时生效
  - 查看别名配置文件 `cat ~/.bashrc`
  - 可以写入配置文件 然后执行 `source ~/.bashrc`
- `unalias`: 删除别名
- 快捷命令
  - `ctrl+c`: 强制终止当前命令
  - `ctrl+l`: 清屏
  - `ctrl+a`: 光标移动到命令行首
  - `ctrl+e`: 光标移动到命令行尾
  - `ctrl+u`: 从光标所在的位置删除到行首
- `history`: 历史命令
  - `-c`: 清空历史命令
  - `-w`: 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history
  - 默认保存 1000 条 /etc/profile HISSIZE=10000
  - 使用 `!n` 表示执行第 n 条历史命令
  - 使用 `!!` 表示执行上一条命令
  - 使用 `!字符` 重复执行最后一条以该字符串开头的命令
- 输入输出
  - `命令 > 文件`: `echo hello > 1.txt` 将 hello 写入 1.txt (先清空里面的内容)
  - `命令 >> 文件`: `echo hello > 1.txt` 将 hello 写入 1.txt (向已有内容追加)
- `wc`: 统计指定文件中的行数、字数(单词数)、字节数, 并将统计结果显示输出
  - `wc < 1.txt`
- 多命令执行
  - `;`: 例如 `命令1;命令2` 多个命令执行，命令之间没有任何逻辑联系
  - `&&`: 例如 `命令1&&命令2` 当命令 1 正确执行，则命令 2 才会执行
  - `||`: 例如 `命令||命令2` 当命令 1 执行不正确，则命令 2 才会执行
- 管道符号
  - `|`: 例如 `命令1|命令2` 命令 1 的正确输出会作为命令 2 的操作对象
- 通配符
  - `?`: 匹配一个任意字符
  - `*`: 匹配 0 个或任意字符，也就是可以匹配任意内容
  - `[]`: 匹配中括号中任意一个字符
  - `[-]`: 匹配中括号中任意一个字符,-代表范围
  - `[^]`: 匹配不是中括号中的一个字符
- 其他
  - `''`: 单引号。在单引号中所有的特殊符号，如$和`都没有特殊含义
  - `""`: 双引号，在双引号里特殊符号都没有特殊含义，但是 $ ` \ 例外，拥有调用变量值，引用命令和转义的含义
  - ``: 反引号，扩起来的是系统命令
  - `$()`: 和反引号一样
  - `#`: 在 shell 脚本中，#开头的行代表注释
  - `$`: 用于调用变量的值
  - `\`: 转义符号

### 变量

- 介绍
  - 变量必须以字母或下划线开头，名字中间只能由字母，数字和下划线组成
  - 变量名的长度不得超过 255 个字符
  - 变量名在有效范围内必须唯一
  - 变量默认类型都是字符串
- 分类
  - 字符串
  - 整型
  - 浮点型
  - 日期型
- 定义
  - `name="zhufeng"`
  - `age=10`
- 引用
  - `$[变量名]`
  - `"$[变量名]"`: 在赋值的时候引用变量 如 xx = "$name"wyb
  - `${name}`: 在赋值的时候引用变量 如 xx = ${name}wyb
- 查看变量
  - `set`: 查询系统中默认所有已经生效的变量，包括系统变量,也包括自定义变量
    - ` | grep name`: 可以使用管道符进行过滤
- 删除
  - `unset [变量名]`
- 环境变量
  - 介绍
    - 环境变量是全局变量，而自定义变量是局部变量
    - 自定义变量会在当前的 shell 中生效，而环境变量会在当前 shell 以及其子 shell 中生效，其他窗口无法访问
    - 这种变量主要保存的是和系统操作环境相关的数据
    - 变量可以自定义，但是对系统生效的环境变量名和变量作用是固定的
  - 定义
    - `export [变量名]=[变量值]`
  - 查看
    - `env`: 仅仅用来查看环境变量，而不看到本地变量，也可以使用管道符
  - 常用
    - `HOSTNAME`: 主机名 HOSTNAME=localhost
    - `SHELL`: 当前的 shell SHELL=/bin/bash
    - `HISTSIZE`: 历史命令条数 HISTSIZE=1000
    - `SSH_CLIENT`: 当前操作环境如果是用 SSH 连接的话，这里会记录客户端 IP SSH_CLIENT=192.168.1.100 57596 22
    - `USER`: 当前登录的用户 USER=root
    - `PATH`: 系统命令搜索路径
- 语系环境变量
  - 介绍
    - 在 Linux 中通过 locale 来设置程序运行的不同语言环境，locale 由 ANSI C 提供支持
    - locale 的命名规则为<语言>\_<地区>.<字符集编码>，如 zh_CN.UTF-8
    - zh 代表中文，CN 代表大陆地区，UTF-8 表示字符集
    - `LANG`: 定义系统主语系的变量
- 脚本参数
  - 介绍
    - 这种变量主要是用来向脚本当中传递参数或数据的，变量名不能自定义，变量作用是固定的
  - 参数
    - `$n`: n 为数字，$0代表命令本身，$1-$9代表第1到第9个参数，10以上的参数需要用大括号包含,如${10}
    - `$@`: 这个变量也代表命令行中所有的参数，不过$@把每个参数进行区分
    - `$#`: 这个变量代表命令行中所有参数的个数
    - `$*`: 这个变量代表命令中所有的参数，$\*把所有的变看数看成一个整体
- 预定义变量
  - 介绍
    - 是脚本中已经定义好的变量，变量名不能自定义，变量作用也是固定的
  - 变量
    - `$?`: 最后一次执行的命令的返回状态。0 表示正确执行，非 0 表示不正确执行
    - `$$`: 当前进程的进程号(PID)
- read
  - 变量
    - `-p`: 提示信息，在等待 read 输入时，输出提示信息
    - `-t`: 秒数: read 命令会一直等待用户输入，使用此选项可以指定等待时间
    - `-n`: 字符数，read 命令只接受指定的字符数，就会执行
    - `-s`: 隐藏输入的数据，适用于机密信息的输入
  - 示例
  ```bash
  #!/bin/bash
  read -p 'please input your name:' -t 5 name
  echo -e "\n"
  read -p 'please input you gender[m/f]:' -n 1 gender
  echo -e "\n"
  read -p 'please input your password:' -s password
  echo -e "\n"
  echo $name,$gender,$password
  ```

### 运算符

- declare 命令

  - `declare [+/-] [选项] [变量名]`: 用来声明变量类型

    - `-`: 给变量设定类型属性
    - `+`: 取消变量的类型属性
    - `-a`: 将变量声明为数组类型

    ```js
    // 声明为数组类型
    declare -a names;
    names[0]=zhangsan
    names[1]=lisi
    // 默认只打印第一个元素
    echo ${names}
    zhangsan
    // 打印第2个元素
    echo ${names[1]}
    lisi
    // 打印全部
    echo ${names[*]}
    zhangsan lisi
    ```

    - `-i`: 将变量声明为整数型
    - `-x`: 将变量声明为环境变量
      - 也可以使用 `export NAME=zhufeng` === `declare -x NAME=zhufeng`
    - `-r`: 将变量声明为只读变量
    - `-p`: 显示指定变量的被声明的类型

  - 运算 expr 或 let
    - 符号左右两侧必须有空格,否则还是整块输出
    ```js
    num1=2
    num2=3
    sum=$(expr $num1 + $num2)
    echo $sum
    5
    ```

### 环境变量配置文件

- source 命令
  - 修改完配置文件后，必须注销重新登录才能生效，使用 `source` 获取 `.` 命令可以不用重新登录
  - `source [配置文件]`
  - `. [配置文件]`
- 变量配置文件简介
  - `/etc/profile`: 系统变量。针对所有 sheel 生效
  - `/etc/bashrc`: 系统变量。只针对 bash sheel 生效
  - `~/.bash_profile`: 环境变量。针对所有 sheel 生效
  - `~/.bashrc`: 环境变量。只针对 bash sheel 生效
  - `~/.bash_logout`: 注销时生效的环境变量配置文件
  - `~/.bash_history`: 当正确退出计算机的时候会历史记录会写入文件
  - Shell 登录信息
    - `/etc/issue`: 本地终端欢迎信息
    - `/etc/issue.net`: 远程终端欢迎信息
    - `/etc/motd`: 不管远程还是本地都可以生效
    - 可用变量
      - `\d`: 当前系统日期
      - `\s`: 显示操作系统名称
      - `\l`: 显示登录的终端号
      - `\m`: 显示硬件体系结构，如 i386 等
      - `\n`: 显示主机名
      - `\o`: 显示域名
      - `\r`: 显示内核版本
      - `\t`: 显示当前系统时间
      - `\u`: 显示当前登录用户的序列号

### 正则表达式

- `cut`
- `printf`
- `awk`
- `BEGIN`
- `END`
- `FS`
- `NR`
- `OFS`
- `sed`
- `sort`
- `wc`

### 流程控制
